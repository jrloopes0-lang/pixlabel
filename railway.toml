[build]
builder = "nixpacks"

[build.nixpacks]
node = "20"
buildCommand = "npm ci && npm run build"

[deploy]
startCommand = "NODE_ENV=production node dist/index.js"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 3

[deploy.environment]
HOST = "0.0.0.0"

[healthcheck]
enabled = true
path = "/api/health"
timeout = 5
interval = 15
successThreshold = 1
failureThreshold = 2
